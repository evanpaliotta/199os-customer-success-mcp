# 199|OS Customer Success MCP Server Environment Variables
# Copy this file to .env and configure as needed

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================

SERVER_NAME=199OS-CustomerSuccess
SERVER_PORT=8080

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=json

# Database Configuration (PostgreSQL for production)
DATABASE_URL=postgresql://postgres:password@localhost:5432/cs_mcp_db
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_SSL_MODE=require

# Redis Configuration (for caching and sessions)
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=your-redis-password
REDIS_MAX_CONNECTIONS=50
CACHE_DEFAULT_TTL=3600
CACHE_LONG_TTL=86400

# Rate Limiting
MAX_REQUESTS_PER_MINUTE=1000
MAX_REQUESTS_PER_HOUR=10000
RATE_LIMIT_PER_CLIENT_PER_MINUTE=100

# ============================================================================
# SECURITY CONFIGURATION (CRITICAL)
# ============================================================================

# Master password for encrypting stored credentials
# Generate with: openssl rand -base64 32
MASTER_PASSWORD=your-strong-master-password-here

# Encryption key for sensitive data
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=your-encryption-key-here

# Master encryption key for platform API credentials (Zendesk, Intercom, Salesforce, HubSpot, etc.)
# CRITICAL: Generate a new key for production with:
# python -c 'from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())'
# NEVER commit the actual key to version control!
CREDENTIAL_ENCRYPTION_KEY=your-base64-encryption-key-here-GENERATE-NEW-IN-PRODUCTION

# Credential rotation policy (days)
# Recommended: 90 days for security best practices
CREDENTIAL_ROTATION_DAYS=90

# JWT secret for token generation
# Generate with: openssl rand -base64 64
JWT_SECRET=your-jwt-secret-here

# API key for MCP server authentication
MCP_API_KEY=your-mcp-api-key-here

# Webhook secret for verifying incoming webhooks
WEBHOOK_SECRET=your-webhook-secret

# ============================================================================
# LEARNING SYSTEM CONFIGURATION
# ============================================================================

# Confidence threshold for learning questions (0.0 - 1.0)
LEARNING_COMPLETION_THRESHOLD=0.70

# Learning frequency: always, often, occasionally, rarely
LEARNING_FREQUENCY=often

# Preference storage location
PREFERENCES_DIR=./config/preferences

# ============================================================================
# CUSTOMER SUCCESS PLATFORM INTEGRATIONS
# ============================================================================

# Zendesk (Support Platform)
ZENDESK_SUBDOMAIN=your-subdomain
ZENDESK_EMAIL=your-email@company.com
ZENDESK_API_TOKEN=your-zendesk-api-token

# Intercom (Customer Messaging)
INTERCOM_ACCESS_TOKEN=your-intercom-access-token
INTERCOM_APP_ID=your-intercom-app-id

# Mixpanel (Product Analytics)
MIXPANEL_PROJECT_TOKEN=your-mixpanel-project-token
MIXPANEL_API_SECRET=your-mixpanel-api-secret

# Gainsight (CS Platform)
GAINSIGHT_API_KEY=your-gainsight-api-key
GAINSIGHT_BASE_URL=https://your-instance.gainsightcloud.com

# Amplitude (Product Analytics)
AMPLITUDE_API_KEY=your-amplitude-api-key
AMPLITUDE_SECRET_KEY=your-amplitude-secret-key

# SendGrid (Email)
SENDGRID_API_KEY=your-sendgrid-api-key
SENDGRID_FROM_EMAIL=noreply@yourcompany.com
SENDGRID_FROM_NAME=Your Company
SENDGRID_MAX_RETRIES=3
SENDGRID_RETRY_DELAY=1
SENDGRID_BATCH_SIZE=1000

# Segment (Customer Data Platform)
SEGMENT_WRITE_KEY=your-segment-write-key

# Salesforce (CRM Sync)
SALESFORCE_USERNAME=your-salesforce-username
SALESFORCE_PASSWORD=your-salesforce-password
SALESFORCE_SECURITY_TOKEN=your-security-token

# HubSpot (CRM/Marketing)
HUBSPOT_ACCESS_TOKEN=your-hubspot-access-token

# Slack (Community/Communication)
SLACK_BOT_TOKEN=xoxb-your-bot-token
SLACK_SIGNING_SECRET=your-signing-secret

# Typeform (Surveys)
TYPEFORM_ACCESS_TOKEN=your-typeform-access-token

# Freshdesk (Support)
FRESHDESK_API_KEY=your-freshdesk-api-key
FRESHDESK_DOMAIN=your-domain.freshdesk.com

# ============================================================================
# MCP SERVER INTEGRATIONS
# ============================================================================

# Enable/disable specific MCP servers
MCP_ENABLE_ZENDESK=true
MCP_ENABLE_INTERCOM=true
MCP_ENABLE_MIXPANEL=true
MCP_ENABLE_SALESFORCE=true
MCP_ENABLE_HUBSPOT=true
MCP_ENABLE_SENDGRID=true
MCP_ENABLE_SLACK=true

# MCP configuration file path
MCP_CONFIG_PATH=./config/mcp_servers.json

# ============================================================================
# HEALTH SCORE CONFIGURATION
# ============================================================================

# Health score weights (must sum to 1.0)
HEALTH_SCORE_WEIGHT_USAGE=0.35
HEALTH_SCORE_WEIGHT_ENGAGEMENT=0.25
HEALTH_SCORE_WEIGHT_SUPPORT=0.15
HEALTH_SCORE_WEIGHT_SATISFACTION=0.15
HEALTH_SCORE_WEIGHT_PAYMENT=0.10

# Health score thresholds
HEALTH_SCORE_AT_RISK_THRESHOLD=50
HEALTH_SCORE_HEALTHY_THRESHOLD=75
HEALTH_SCORE_CHAMPION_THRESHOLD=90

# Churn prediction thresholds
CHURN_PROBABILITY_HIGH_RISK=0.70
CHURN_PROBABILITY_MEDIUM_RISK=0.40
CHURN_PROBABILITY_LOW_RISK=0.15

# ============================================================================
# ONBOARDING CONFIGURATION
# ============================================================================

# Time-to-value targets (in days)
TIME_TO_VALUE_TARGET=30
TIME_TO_FIRST_VALUE=7
TIME_TO_ACTIVATION=14

# Onboarding milestone thresholds
ONBOARDING_COMPLETION_THRESHOLD=0.80
TRAINING_COMPLETION_THRESHOLD=0.75

# ============================================================================
# RETENTION CONFIGURATION
# ============================================================================

# Retention campaign thresholds
RETENTION_CAMPAIGN_TRIGGER_SCORE=60
RETENTION_CAMPAIGN_FREQUENCY_DAYS=7
RETENTION_ESCALATION_SCORE=40

# Renewal reminder timeline
RENEWAL_REMINDER_DAYS_BEFORE=90,60,30,14,7
RENEWAL_FORECAST_WINDOW_DAYS=90

# ============================================================================
# EXPANSION CONFIGURATION
# ============================================================================

# Expansion opportunity thresholds
EXPANSION_MIN_HEALTH_SCORE=75
EXPANSION_MIN_USAGE_THRESHOLD=0.70
EXPANSION_MIN_TENURE_DAYS=60

# Upsell/cross-sell scoring
UPSELL_OPPORTUNITY_THRESHOLD=0.65
CROSS_SELL_OPPORTUNITY_THRESHOLD=0.60

# ============================================================================
# SUPPORT CONFIGURATION
# ============================================================================

# SLA targets (in minutes)
SUPPORT_FIRST_RESPONSE_SLA=15
SUPPORT_RESOLUTION_SLA_P1=240   # 4 hours
SUPPORT_RESOLUTION_SLA_P2=480   # 8 hours
SUPPORT_RESOLUTION_SLA_P3=1440  # 24 hours

# Escalation thresholds
SUPPORT_ESCALATION_NO_RESPONSE_HOURS=2
SUPPORT_ESCALATION_NO_RESOLUTION_DAYS=3

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================

# Enable features
ENABLE_MONITORING=true
ENABLE_AUDIT_LOGGING=true
ENABLE_TRACING=true

# Audit log settings
AUDIT_LOG_RETENTION_DAYS=90
AUDIT_LOG_DIR=./config/audit_logs

# Error tracking (Sentry - optional)
# SENTRY_DSN=your-sentry-dsn

# Metrics (DataDog - optional)
# DATADOG_API_KEY=your-datadog-api-key

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable/disable features
FEATURE_CHURN_PREDICTION=true
FEATURE_HEALTH_SCORING=true
FEATURE_AUTOMATED_RETENTION=true
FEATURE_EXPANSION_SCORING=true
FEATURE_SENTIMENT_ANALYSIS=true
FEATURE_AUTO_TICKET_ROUTING=true
FEATURE_KNOWLEDGE_BASE_SYNC=true
FEATURE_EBR_AUTOMATION=true
